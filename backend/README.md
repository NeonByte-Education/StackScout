<div align="center">

# StackScout

**Интеллектуальная платформа для анализа Open Source библиотек**

[![Coverage](https://img.shields.io/codecov/c/github/yourusername/stackscout)](https://codecov.io/gh/yourusername/stackscout)
[![License: MIT](https://img.shields.io/badge/License-MIT-blue.svg)](LICENSE)
[![Spring Boot](https://img.shields.io/badge/Spring%20Boot-3.5.10-6DB33F?logo=springboot)](https://spring.io/projects/spring-boot)
[![Java](https://img.shields.io/badge/Java-21-007396?logo=openjdk)](https://openjdk.org/)

[Возможности](#возможности) • [Архитектура](#архитектура) • [Быстрый старт](#быстрый-старт) • [API Документация](#api-документация) • [Roadmap](#roadmap)

</div>

---

## О проекте

### Проблема: Dependency Hell

Современная разработка программного обеспечения во многом зависит от сторонних библиотек. Однако выбор правильной зависимости представляет серьезную проблему:

- **Уязвимости безопасности**: Устаревшие или заброшенные пакеты
- **Конфликты лицензий**: Несовместимые условия лицензирования (GPL vs MIT)
- **Риск поддержки**: Библиотеки без недавних обновлений
- **Плохая документация**: Отсутствие информации перед внедрением

### Решение: StackScout

**StackScout** — это интеллектуальный микросервис на **Java Spring Boot** для **управления программными активами (Software Asset Management)**, который автоматизирует сбор, анализ и мониторинг open-source библиотек из PyPI и Docker Hub.

Наша платформа предоставляет:

- Оценку "здоровья" библиотек в реальном времени
- Валидацию соответствия лицензиям
- Автоматический сбор метаданных
- Полнофункциональный REST API с аналитикой

---

## Архитектура

```
┌──────────────────┐      ┌──────────────────┐      ┌──────────────────┐
│ Источники данных │      │   StackScout     │      │     Клиенты      │
│                  │      │   Микросервис    │      │                  │
│  • PyPI API      │─────▶│                  │◀─────│  • Веб-приложение│
│  • Docker Hub    │      │  ┌────────────┐  │      │  • CLI утилиты   │
│                  │      │  │ Коллектор  │  │      │  • Интеграции    │
└──────────────────┘      │  └──────┬─────┘  │      └──────────────────┘
                          │         │        │
                          │  ┌──────▼─────┐  │
                          │  │ PostgreSQL │  │
┌──────────────────┐      │  └──────┬─────┘  │      ┌──────────────────┐
│   Мониторинг     │      │         │        │      │  Очередь задач   │
│                  │◀─────│  ┌──────▼─────┐  │─────▶│                  │
│  • Prometheus    │      │  │  REST API  │  │      │  • Redis         │
│  • Grafana       │      │  └────────────┘  │      │  • BullMQ        │
└──────────────────┘      └──────────────────┘      └──────────────────┘
```

### Основные компоненты

| Компонент            | Технология                   | Назначение                                 |
| -------------------- | ---------------------------- | ------------------------------------------ |
| **API слой**         | Spring Boot + Spring Web     | RESTful endpoints с JWT авторизацией       |
| **Слой данных**      | PostgreSQL + Spring Data JPA | Постоянное хранилище и ORM                 |
| **Слой кэширования** | Redis + Spring Cache         | Управление сессиями и ограничение запросов |
| **Система очередей** | Spring AMQP + RabbitMQ       | Асинхронный парсинг и планирование         |
| **Мониторинг**       | Prometheus + Grafana         | Сбор метрик и визуализация                 |

---

## Возможности

### Сборщик данных (Data Collector)

- Автоматический сбор метаданных через официальные API (PyPI JSON API, Docker Registry API)
- Планируемый парсинг через Cron jobs (настраиваемые интервалы)
- Параллельная обработка с использованием очередей задач
- Нормализация и дедупликация данных

### Модуль лицензионного соответствия

- Нормализация названий лицензий (`"MIT License"` → `"MIT"`)
- Классификация рисков:
  - **Разрешающие**: MIT, Apache-2.0, BSD
  - **Copyleft**: GPL, AGPL, MPL
  - **Проприетарные**: Пользовательские лицензии
- Матрица совместимости для проектов с множественными лицензиями

### Алгоритм оценки здоровья

Интеллектуальная система оценки на основе:

- **Актуальность**: Время с момента последнего релиза (0-40 баллов)
- **Активность**: Количество релизов за последний год (0-30 баллов)
- **Репозиторий**: Наличие официального исходного кода (0-20 баллов)
- **Сообщество**: Количество контрибьюторов и активность (0-10 баллов)

**Интерпретация оценок**:

- **80-100**: Отлично (Готово к production)
- **60-79**: Хорошо (Рекомендуется проверка)
- **40-59**: Удовлетворительно (Использовать с осторожностью)
- **0-39**: Плохо (Избегать или заменить)

### Защищенный API

- JWT-авторизация (Spring Security)
- Управление доступом на основе ролей (RBAC)
- Ограничение количества запросов (100 запросов/мин на API ключ)
- Валидация входных данных с Bean Validation
- Спецификация OpenAPI 3.0 (SpringDoc)

### Наблюдаемость (Observability)

- Пользовательские метрики Prometheus (`http_requests_total`, `library_scan_duration`)
- Готовые дашборды Grafana
- Spring Boot Actuator для проверки здоровья (`/actuator/health`, `/actuator/prometheus`)
- Структурированное логирование с Logback

---

## Быстрый старт

### Требования

- **Java** 21 или выше
- **Git**

### Установка и запуск (без Docker)

Проект настроен для работы "из коробки" без дополнительных настроек!

1. **Клонируйте репозиторий**

   ```bash
   git clone https://github.com/NeonByte-Education/StackScout.git
   cd StackScout
   ```

2. **Запустите приложение**

   ```bash
   ./gradlew bootRun
   ```

   Приложение автоматически:
   - Использует встроенную H2 базу данных в памяти
   - Запустится на порту 8081
   - Отключит Redis и RabbitMQ
   - Настроит H2 консоль для просмотра данных

3. **Получите доступ к приложению**
   - API: http://localhost:8081
   - H2 Console: http://localhost:8081/h2-console
     - JDBC URL: `jdbc:h2:mem:stackscout`
     - Username: `sa`
     - Password: (оставить пустым)
   - Swagger документация: http://localhost:8081/swagger-ui.html
   - Actuator: http://localhost:8081/actuator

### Запуск с Docker (Production режим)

Для полноценного окружения с PostgreSQL, Redis и RabbitMQ:

#### Шаг 1: Запустите инфраструктуру (в корне проекта)

```bash
cd /Users/stanislavmamaev/Documents/Development/StackScout/StackScout
docker-compose up -d postgres redis rabbitmq
```

**Проверьте статус контейнеров:**

```bash
docker-compose ps
```

Все три сервиса должны быть в статусе `Up` и `healthy` (это займет ~15-20 секунд).

#### Шаг 2: Запустите бэкенд (в папке backend)

```bash
cd backend
./gradlew bootRun
```

Приложение запустится на **http://localhost:8081**

**Проверьте работоспособность:**

```bash
curl http://localhost:8081/actuator/health
```

#### Шаг 3: Запустите фронтенд (в отдельном терминале)

```bash
cd frontend
npm run dev
```

Приложение откроется на **http://localhost:3000**

#### Остановка всех сервисов

```bash
# В отдельных терминалах где запущены бэкенд и фронтенд:
Ctrl+C

# Остановить Docker контейнеры (в корне проекта):
cd /path/to/StackScout
docker-compose down
```

### Режимы работы

#### Dev режим (по умолчанию)

- H2 база данных в памяти
- Без Redis и RabbitMQ
- H2 Console включена
- SQL логирование включено
- Автоматическое создание схемы БД

```bash
./gradlew bootRun --args='--spring.profiles.active=dev'
```

#### Production режим

- PostgreSQL база данных
- Redis для кэширования
- RabbitMQ для очередей
- Flyway миграции
- Полный мониторинг

```bash
docker-compose up -d
./gradlew bootRun
```

### Режим разработки

```bash
# Сборка проекта
./gradlew build

# Запуск в режиме разработки с автоперезагрузкой
./gradlew bootRun

# Запуск тестов
./gradlew test

# Очистка и полная пересборка
./gradlew clean build

# Запуск с профилем
./gradlew bootRun --args='--spring.profiles.active=dev'
```